!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("antd"),require("moment")):"function"==typeof define&&define.amd?define(["react","antd","moment"],t):"object"==typeof exports?exports["antd-doddle"]=t(require("react"),require("antd"),require("moment")):e["antd-doddle"]=t(e[void 0],e[void 0],e[void 0])}(window,function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";n.r(t),n.d(t,"DATE_FORMAT",function(){return i}),n.d(t,"DATE_TIME_FORMAT",function(){return l}),n.d(t,"formItemLayout",function(){return o}),n.d(t,"isEmpty",function(){return c}),n.d(t,"getEnumObject",function(){return d}),n.d(t,"toFormatEnums",function(){return u}),n.d(t,"throttle",function(){return h}),n.d(t,"compileParam",function(){return m}),n.d(t,"unCompileParam",function(){return g}),n.d(t,"idCodeValid",function(){return f}),n.d(t,"getSexById",function(){return b}),n.d(t,"getAgeById",function(){return y}),n.d(t,"toDecimalNumber",function(){return v}),n.d(t,"Type",function(){return O}),n.d(t,"Rules",function(){return C});var a=n(3),r=n.n(a),s=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};const i="YYYY-MM-DD",l="YYYY-MM-DD HH:mm:ss",o={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:15}}},c=e=>null===e||"object"==typeof e&&0===Object.keys(e).length,d=(e,t,n="value")=>{const a=e.filter(e=>e[n]===t);return a.length>0?a[0]:{}},u=(e=[],t,n)=>e.map(e=>"string"==typeof e?{label:e,value:e}:{label:e[n],value:e[t]}),h=(e,t=800,n=300)=>{let a,r=Date.now();return function(i){var l=s(i,[]);const o=Date.now();clearTimeout(a),o-r>=n?(e(l),r=o):a=setTimeout(()=>{e(l)},t)}},p=17;function m(e=""){let t=String.fromCharCode(e.charCodeAt(0)+p+e.length);for(let n=1;n<e.length;n+=1)t+=String.fromCharCode(e.charCodeAt(n)+e.charCodeAt(n-1));return t}function g(e=""){let t=String.fromCharCode(e.charCodeAt(0)-p-e.length);for(let n=1;n<e.length;n+=1)t+=String.fromCharCode(e.charCodeAt(n)-t.charCodeAt(n-1));return t}function f(e,t,n=4,a=4){if(t&&e.indexOf("*")===n&&e.lastIndexOf("*")===e.length+1-a)return!0;let s=!0;if(e&&/^\d{6}(18|19|20)\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))if({11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"}[e.substr(0,2)])if(r()(`${e.substring(6,10)}-${e.substring(10,12)}-${e.substring(12,14)}`)>r()())s=!1;else{const t=e.split(""),n=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=[1,0,"X",9,8,7,6,5,4,3,2];let r=0,i=0,l=0;for(let e=0;e<17;e+=1)r+=(i=+t[e])*(l=n[e]);a[r%11].toString()!==t[17]&&(s=!1)}else s=!1;else s=!1;return s}function b(e=""){let t="-1";return f(e)&&(t=parseInt(e.substr(16,1),10)%2==1?"0":"1"),t}function y(e=""){let t=-1;if(f(e)){const n=r()(`${e.substring(6,10)}-${e.substring(10,12)}-${e.substring(12,14)}`),a=n.year(),s=n.month(),i=n.date(),l=r()(),o=l.year(),c=l.month(),d=l.date();t=o-a,(s>c||s===c&&i>d)&&(t-=1)}return t}function v(e=0,t=2){return(+e).toFixed(t).replace(/(\d{1,3})(?=(\d{3})+(\.|$))/g,"$1,")}const O={isObject:e=>"[object Object]"===Object.prototype.toString.call(e),isFunction:e=>null!=e&&(e.constructor===Function||e instanceof Function),isArray:e=>Array.isArray(e),isString:e=>"string"==typeof e||!!e&&"object"==typeof e&&"[object String]"===Object.prototype.toString.call(e),isNumber:e=>null!=e&&(e.constructor===Number||e instanceof Number),isEmpty(e){if(null==e)return!0;if("string"==typeof e)return""===e;if("function"==typeof e)return!1;if(e instanceof Array)return!e.length;if(e instanceof Object){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}}},C={chineseWord:/^([\u4e00-\u9fa5])+$/,normalWord:/^([\u4e00-\u9fa5-a-zA-Z0-9_-—])+$/,email:/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(?:\.[0-9A-Za-z]+)+$/,phone:/^((13[0-9])|(14[0-9])|(15[0-9])|(16[0-9])|(17[0-9])|(18[0-9])|(19[0-9]))\d{8}$/,fix2:/^([1-9]\d*$)|([1-9]\d*\.(\d{1,2})$)|(0\.((0[1-9])|([1-9]\d?))$)/,positive:/(^0\.0*[1-9]+[0-9]*$)|(^[1-9]\d*(\.\d+)?$)/,positiveInteger:/^[1-9]\d*$/,notNegtive:/^\d*(\.\d+)?$/,notNegtiveInteger:/^\d*$/,rate:/^0\.0[1-9]\d{0,3}$|^0\.10{0,4}$/,rate2:/^0(\.0\d{0,4})?$|^0\.10{0,4}$/,amount:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^\d\.\d{1,2}$)/,percent:/^100$|^([1-9]|[1-9]\d)(\.\d{1,2})*$/,thousandth:/(\d{1,3})(?=(\d{3})+$)/g,thousandthWithPoint:/(\d{1,3})(?=(\d{3})+(\.|$))/g}},function(e,t){e.exports=n},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(1),i=n(2),l=n(3),o=n.n(l);n(4);const{Option:c}=s.AutoComplete,d=r.a.createElement(c,{key:"empty",disabled:!0},"暂无可匹配的搜索结果");class u extends r.a.Component{constructor(e){super(e),this.state={isShowSearch:!1,loading:!1,options:[],seachRes:[],value:e.value,search:e.search||{}},this.lastFethId=0,this.load=this.load.bind(this),this.lazyLoad=Object(i.throttle)(this.load,800),this.handleChange=this.handleChange.bind(this),this.handleSelect=this.handleSelect.bind(this),this.handleOpenSearch=this.handleOpenSearch.bind(this),this.handleCloseSearch=this.handleCloseSearch.bind(this),this.handleRemove=this.handleRemove.bind(this)}static getDerivedStateFromProps(e,t){const{value:n}=e;return t.value&&t.value===n?null:{value:e.value}}load(e){this.lastFethId+=1;const t=this.lastFethId,{fetchData:n,format:a}=this.props;this.setState({loading:!0,options:null}),n(e).then(e=>{if(t!==this.lastFethId)return;let n;!(n=Object(i.isEmpty)(e)?[d]:a(e).map(({label:e,value:t},n)=>r.a.createElement(c,{key:n,value:String(t)},e))).length&&n.push(d),this.setState({options:n,loading:!1,seachRes:e})})}handleOpenSearch(){this.setState({isShowSearch:!0})}handleCloseSearch(){this.setState({isShowSearch:!1})}handleSelect(e,t){const{onSelect:n}=this.props,{seachRes:a}=this.state,r=t.key||t.props.index,s=n?n(e,r,a):e;this.triggerChange(s),this.setState({value:s}),this.handleCloseSearch()}handleChange(e){const{searchKey:t="keyword"}=this.props,{search:n}=this.state,a=Object.assign({},n,{[t]:e});e&&this.lazyLoad(a)}handleRemove(){this.setState({value:void 0}),this.triggerChange(void 0)}triggerChange(e){const{onChange:t}=this.props;t&&t(e)}render(){const{style:e,valueFormat:t=(e=>e),disabled:n=!1,placeholder:a="请输入",allowClear:i=!1,maxSize:l=500}=this.props,{options:o,isShowSearch:d,value:u,loading:h}=this.state,p=d?{disabled:!0}:{onClick:this.handleOpenSearch},m=t(u),g=m&&String(m).length>l,f=Object.assign({disabled:n,allowClear:!n&&i,placeholder:a,readOnly:!0,value:m,style:{width:"100%"},onChange:this.handleRemove},p);return r.a.createElement("div",{className:"doddle-input-search",style:e},g?r.a.createElement(s.Tooltip,{className:"whatip",title:m},r.a.createElement(s.Input,Object.assign({},f))):r.a.createElement(s.Input,Object.assign({},f)),d&&r.a.createElement("div",{className:"js-origin-search origin-search"},r.a.createElement(s.Icon,{type:"search",className:"origin-search-icon"}),r.a.createElement(s.AutoComplete,{autoFocus:!0,className:"certain-category-search",dropdownClassName:"certain-category-search-dropdown",dropdownMatchSelectWidth:!0,onBlur:this.handleCloseSearch,onSearch:this.handleChange,onSelect:this.handleSelect,style:{width:"100%"},optionLabelProp:"value"},h?[r.a.createElement(c,{key:"loading",disabled:!0},r.a.createElement(s.Spin,{spinning:h,style:{paddingLeft:"45%",textAlign:"center"}}))]:o)))}}n(5);const h=1048576;const p=e=>e.match(/[0-9,a-z,.]{9,}(?=\?)/)[0];function m(e){s.Modal.info({title:"提示",content:e})}const g=(e="picture-card")=>"picture-card"===e?r.a.createElement("div",null,r.a.createElement(s.Icon,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"上传")):r.a.createElement(s.Button,null,r.a.createElement(s.Icon,{type:"upload"}),"选择文件");class f extends r.a.PureComponent{constructor(e){super(e),this.beforeUpload=e=>{const{listType:t="picture-card",reg:n=/(jpe?g|JPE?G|png|PNG)$/,tips:a="请选择jpg,png类型的图片格式",fileSize:r=5}=this.props,s=e.name,i=e.size;return new Promise((l,o)=>{if(!n.test(s))return m(a),void o();if(i>r*h)return m(`文件的大小不能超 ${r}M`),void o();if("picture-card"===t){const t=new Image;t.onload=()=>{l()},t.onerror=o,t.src=URL.createObjectURL(e)}else l()})},this.customRequest=e=>{const{upload:t}=this.props,{file:n,onSuccess:a}=e;t({file:n}).then(e=>{const{content:t}=e;a({content:t})}).catch(()=>{console.log("some error")})},this.handleChange=({file:e,fileList:t})=>{const{ids:n}=this.state,{onChange:a}=this.props;if("done"===e.status){const{storeId:t}=e.response.content,r=n.concat(t);this.setState({ids:r}),function(e,t){const n=new FileReader;n.addEventListener("load",()=>t(n.result)),n.readAsDataURL(e)}(e.originFileObj,t=>e.thumbUrl=t),a&&a(r.join(","),e.name)}this.setState({fileList:t})},this.handlePreview=e=>{const{listType:t="picture-card"}=this.props;"picture-card"===t&&this.setState({imageUrl:e.url||e.thumbUrl,previewVisible:!0})},this.handleSimplePreview=e=>()=>{this.setState({imageUrl:e,previewVisible:!0})},this.handleCancel=()=>{this.setState({previewVisible:!1})},this.handleRemove=e=>{const{ids:t}=this.state;let n;if(e.specialId)n=t.indexOf(e.uid);else{if(!e.response||!e.response.content)return!0;{const{storeId:a}=e.response.content;n=t.indexOf(a)}}if(-1===n)return!0;const{onChange:a}=this.props;return t.splice(n,1),a&&a(t.length?t.join(","):void 0),this.setState({ids:t}),!0};const{url:t,name:n,value:a}=e;this.state={initUrl:t,imageUrl:"",ids:t?[a]:[],previewVisible:!1,fileList:t?[{uid:a,name:n,status:"done",specialId:a,url:t}]:[]}}static getDerivedStateFromProps(e,t){if(!t.initUrl&&e.url){const{url:t,name:n,value:a}=e;return{initUrl:t,ids:[a],fileList:[{uid:a,name:n||p(t),status:"done",url:t,specialId:a}]}}return null}render(){const{maxSize:e=1,listType:t="picture-card",children:n,simple:a,info:i,disabled:l}=this.props,o=n||g(t),{imageUrl:c,fileList:d,previewVisible:u}=this.state;return r.a.createElement("div",{className:"doddle-image-upload"},r.a.createElement("div",{className:d.length?"imgArea has-child":"imgArea"},r.a.createElement(s.Upload,{listType:t,fileList:d,disabled:l,beforeUpload:this.beforeUpload,onPreview:this.handlePreview,customRequest:this.customRequest,onChange:this.handleChange,onRemove:this.handleRemove},d.length>=e?null:o),a&&0===d.length&&r.a.createElement("img",{src:a,alt:"样例",onClick:this.handleSimplePreview(a),className:"show-simple"})),i&&0===d.length&&r.a.createElement("div",{className:"show-info"},i),r.a.createElement(s.Modal,{visible:u,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"",style:{width:"100%"},src:c})))}}const b=s.Select.Option,y=[{value:"M",label:"分钟"},{value:"H",label:"小时"},{value:"D",label:"天"}];class v extends r.a.Component{constructor(e){super(e);const{value:t={},defaultUnit:n}=this.props;this.state={number:t.number,unit:t.unit||n},this.handleChange=this.handleChange.bind(this),this.trigger=this.trigger.bind(this)}static getDerivedStateFromProps(e,t){const{value:n={}}=e;return"number"in n&&t.number!==n.number?Object.assign({},e.value||{}):null}handleChange(e,t){const n=this.state;this.setState({[t]:e}),this.trigger(Object.assign({},n,{[t]:e}))}trigger(e){const{onChange:t}=this.props;t&&t(e)}render(){const{enums:e=y,inputProps:t={},selectProps:n={}}=this.props,a=this.state;return r.a.createElement("span",null,r.a.createElement(s.Input,Object.assign({value:a.number,onChange:e=>this.handleChange(e.target.value,"number"),style:{width:"55%",marginRight:"3%"},placeholder:"请输入"},t)),r.a.createElement(s.Select,Object.assign({value:a.unit,style:{width:"32%"},allowClear:!1,onChange:e=>this.handleChange(e,"unit")},n),e.map(({value:e,label:t})=>r.a.createElement(b,{key:e,value:e},t))))}}const O=({field:e,props:t})=>{const{key:n,name:a,seldomProps:s={}}=e;return r.a.createElement(f,Object.assign({info:e.info,url:t.url,name:a,simple:e.psimple,key:n,listType:e.listType,reg:e.reg,fileSize:e.fileSize,tips:e.tips,upload:t.upload||e.upload,maxSize:e.maxSize},s))},C={origin:({field:e,props:t,data:n})=>{const{service:a,searchKey:s,placeholder:i,onSelect:l,allowClear:o,valueFormat:c,format:d,maxSize:h,seldomProps:p,disable:m}=e;return r.a.createElement(u,Object.assign({disabled:m&&m(n),style:{width:"100%",height:32},searchKey:s,onSelect:t.onSelect||l,format:d,placeholder:i,allowClear:o,maxSize:h,valueFormat:c,fetchData:a},p))},image:O,imageUpload:O,selfDefine:({field:e,props:t,data:n})=>e.child({field:e,props:t,data:n}),withUnit:({field:e})=>{const{inputProps:t,selectProps:n,defaultUnit:a,enums:s,seldomProps:i}=e;return r.a.createElement(v,Object.assign({enums:s,selectProps:n,inputProps:t,defaultUnit:a},i))}},S=(e={})=>Object.assign(C,e);var j=C;const E=s.Form.Item,{Option:w}=s.Select,k=s.Radio.Group,{RangePicker:x}=s.DatePicker,{TextArea:P}=s.Input,I=s.Checkbox.Group,R=()=>{},F=e=>()=>e?document.getElementsByClassName(e)[0]:document.body,$=(e,t)=>void 0===e?t:e,N=(e,t)=>t[e]||[],A=e=>r.a.createElement(s.Col,{span:e.span||12},e.children);var D=function(e){const{formItemLayout:t=i.formItemLayout,containerName:n,getFieldDecorator:a,require:l,Wrapper:c=A,withWrap:d=!1}=e;return function(e){const{field:u,data:h={},wrapProps:p={}}=e,{type:m="input",key:g,name:f,style:b={width:"100%"},required:y=l||!1,allowClear:v=!0,placeholder:O,defaultValue:C,disable:S=!1,rules:A=[],maxLength:D,isEnable:T=!0,specialKey:M,onChange:L=R,format:U,withWrap:B,enums:q=[],seldomProps:z={},isDynamic:_=!1}=u,V=u.enumKey||g;let W=null;if(!$(e.isEnable,T))return W;switch(m){case"input":const l=[{required:y,message:O||`请输入${f}`},{pattern:/^\S.*\S$|^\S$/,message:"首尾不能含有空字符"}].concat(A);W=r.a.createElement(E,Object.assign({key:M||g,label:f},t,{className:"self-define-item"}),a(g,{initialValue:h[g],rules:l})(r.a.createElement(s.Input,Object.assign({type:"text",style:b,maxLength:D,onChange:e.onChange||L,placeholder:O||`请输入${f}`,disabled:S&&S(h)},z))));break;case"inputNumber":const{max:c,min:d,precision:p=0,step:R=1}=u;W=r.a.createElement(E,Object.assign({key:M||g,label:f},t,{className:"self-define-item"}),a(g,{initialValue:h[g],rules:[{required:y,message:O||`请输入${f}`}].concat(A)})(r.a.createElement(s.InputNumber,Object.assign({max:c,min:d,step:R,precision:p,style:b,placeholder:O||`请输入${f}`,onChange:e.onChange||L,disabled:S&&S(h)},z))));break;case"text":const{minRows:T=2,maxRows:B=6}=u;W=r.a.createElement(E,Object.assign({key:M||g,label:f},t,{className:"self-define-item"}),a(g,{initialValue:h[g],rules:[{required:y,message:O||`请输入${f}`}].concat(A)})(r.a.createElement(P,Object.assign({type:"text",style:b,maxLength:D||300,placeholder:O||`请输入${f}`,autosize:{minRows:T,maxRows:B},onChange:e.onChange||L,disabled:S&&S(h)},z))));break;case"select":const K=_?N(V,e):e.enums||q;W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(g,{initialValue:$(h[g],C),rules:[{required:y,message:O||`请选择${f}`}].concat(A)})(r.a.createElement(s.Select,Object.assign({style:b,placeholder:O||"不限",allowClear:v,disabled:S&&S(h),onChange:e.onChange||L,getPopupContainer:F(n)},z),K.map(({value:e,label:t})=>r.a.createElement(w,{key:e,value:e},t)))));break;case"radio":const Y=_?N(V,e):e.enums||q;W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(g,{initialValue:$(h[g],C),rules:[{required:y,message:O||`请选择${f}`}].concat(A)})(r.a.createElement(k,Object.assign({options:Y,disabled:S&&S(h),onChange:e.onChange||L},z))));break;case"check":const G=_?N(V,e):e.enums||q;W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(g,{initialValue:$(h[g],C),rules:[{required:y,message:O||`请选择${f}`}].concat(A)})(r.a.createElement(I,Object.assign({options:G,disabled:S&&S(h),onChange:e.onChange||L},z))));break;case"datePicker":W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(g,{initialValue:h[g]&&o()(h[g]),rules:[{required:y,message:O||`请选择${f}`}].concat(A)})(r.a.createElement(s.DatePicker,Object.assign({style:b,showTime:u.showTime||!1,format:U||i.DATE_FORMAT,onChange:e.onChange||L,placeholder:O||"请选择",disabled:S&&S(h),getCalendarContainer:F(n)},z))));break;case"rangePicker":const{startKey:H,endKey:Z,key:X,disabledDate:J=!1,showTime:Q=!1}=u,ee=h[H],te=h[Z],ne=ee&&te?[o()(ee),o()(te)]:[];W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(X,{initialValue:ne,rules:[{required:y,message:O||`请输入${f}`}].concat(A)})(r.a.createElement(x,Object.assign({style:b,allowClear:v,showTime:Q,className:"search-range-picker",onChange:e.onChange||L,format:U||(Q?i.DATE_TIME_FORMAT:i.DATE_FORMAT),getCalendarContainer:F(n),disabledDate:J?e=>(e=>e&&e>o()().endOf("day"))(e):void 0},z))));break;default:if(j[m]){const n=j[m];W=r.a.createElement(E,Object.assign({key:M||g,label:f},t),a(g,{initialValue:h[g],rules:[{required:e.required||y,message:O}].concat(A)})(n({field:u,props:e,data:h})))}else console.error("type is not supported")}return $(e.withWrap,$(B,d))?r.a.createElement(c,Object.assign({},p),W):W}};n(6);var T=s.Form.create()(class extends r.a.PureComponent{constructor(e){super(e),this.state={};const{form:{getFieldDecorator:t}}=e;this.formRender=D({getFieldDecorator:t,containerName:"search-form"}),this.handleSearch=this.handleSearch.bind(this),this.handleReset=this.handleReset.bind(this),this.getFormData=this.getFormData.bind(this)}getFormData(e){const{form:t}=this.props;let n={};return t.validateFields((t,a)=>{n="function"==typeof e?e(a):a}),n}handleSearch(){const{form:e,onSearch:t,paramFormat:n,pageName:a="pageNo"}=this.props;e.validateFields((e,r)=>{if(e)return;const s="function"==typeof n?n(r):r;t(Object.assign({},s,{[a]:1}))})}handleReset(){const{onReset:e,form:t}=this.props;t.resetFields(),e&&e()}render(){const{children:e,form:t,fields:n,search:a,extraBtns:l,onReset:o,dynamicParams:c={}}=this.props,d={search:a,form:t,fields:n,onReset:o,extraBtns:l,formItemLayout:i.formItemLayout,dynamicParams:c,onSearch:this.handleSearch,getFormData:this.getFormData,formRender:this.formRender,handleSearch:this.handleSearch,handleReset:this.handleReset};return r.a.createElement("div",{className:"search-form"},e?e(d):function(e){const{fields:t,formRender:n,search:a,handleSearch:i,handleReset:l,extraBtns:o,onReset:c,dynamicParams:d}=e;return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.Row,null,t.map(e=>r.a.createElement(s.Col,{span:8,key:e.key},n(Object.assign({field:e,data:a},d))))),r.a.createElement("div",{className:"btn-group"},r.a.createElement(s.Button,{type:"primary",onClick:i},"查询"),c&&r.a.createElement(s.Button,{onClick:l},"重置"),o&&o()))}(d))}}),M=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};function L(e,t,n=1){let a=t+n;for(let t=a;1===n&&t<e.length||-1===n&&t>=0;t+=n)if(!e[t].deleteFlag){a=t;break}return a}class U extends r.a.PureComponent{constructor(e){super(e),this.handlMoveUp=e=>()=>{const{rules:t}=this.state,n=t[e],{key:a}=n,r=M(n,["key"]),s=L(t,a,-1);t[e]=Object.assign({},t[s],{key:a}),t[s]=Object.assign({},r,{key:s}),this.setState({rules:[...t]}),this.trigger(t)},this.handlMoveDown=e=>()=>{const{rules:t}=this.state,n=t[e],{key:a}=n,r=M(n,["key"]),s=L(t,a,1);t[e]=Object.assign({},t[s],{key:a}),t[s]=Object.assign({},r,{key:s}),this.setState({rules:[...t]}),this.trigger(t)};const{value:t,disableBtn:n=!1}=e,a=!!t&&t.length>0,r=a?t:[{key:0}];this.state={canReset:!a,rules:r.map((e,t)=>Object.assign({disableBtn:n},e,{key:t}))},this.handlMinus=this.handlMinus.bind(this),this.handlAdd=this.handlAdd.bind(this),this.bindChange=this.bindChange.bind(this),this.trigger=this.trigger.bind(this)}static getDerivedStateFromProps(e,t){const{canReset:n}=t,{value:a=[],disableBtn:r=!1}=e;return n&&a.length>0?{rules:a.map((e,t)=>Object.assign({disableBtn:r},e,{key:t})),canReset:!1}:null}handlAdd(){let{rules:e}=this.state;e=e.concat([{value:void 0,key:e.length}]),this.setState({rules:[...e]}),this.trigger(e)}handlMinus(e){const{rules:t}=this.state;t[e].deleteFlag=!0,this.setState({rules:[...t]}),this.trigger(t)}bindChange(e,t,n){const{rules:a}=this.state;a[t][n]=e,this.setState({rules:[...a]}),this.trigger(a)}trigger(e){const{onChange:t}=this.props;t&&t(e.filter(({deleteFlag:e})=>!e))}render(){const{children:e,canMove:t}=this.props,{rules:n}=this.state,a=this.bindChange,i=n.filter(({deleteFlag:e})=>!e),l=i.length-1;return r.a.createElement("div",{className:"doddle-daynamic-form"},i.map((n,i)=>r.a.createElement("div",{key:n.key},e(n,a),!n.disableBtn&&i>0&&r.a.createElement(s.Button,{style:{marginLeft:10},type:"primary",shape:"circle",icon:"minus",onClick:()=>this.handlMinus(n.key)}),!n.disableBtn&&0===i&&r.a.createElement(s.Button,{style:{marginLeft:10},onClick:this.handlAdd,type:"primary",shape:"circle",icon:"plus"}),!n.disableBtn&&t&&i>0&&r.a.createElement(s.Button,{style:{marginLeft:10},onClick:this.handlMoveUp(n.key),type:"primary",shape:"circle",icon:"up"}),!n.disableBtn&&t&&i<l&&r.a.createElement(s.Button,{style:{marginLeft:10},onClick:this.handlMoveDown(n.key),type:"primary",shape:"circle",icon:"down"}))))}}const B=(e,t)=>(e=>Boolean(e)&&("number"==typeof e||"string"==typeof e))(e)?o()(e).format(t):"",q={normal:e=>e,date:e=>B(e,i.DATE_FORMAT),datetime:e=>B(e,i.DATE_TIME_FORMAT),decimal:e=>Object(i.toDecimalNumber)(e,2),enum:(e,{enums:t})=>Object(i.getEnumObject)(t,e).label||""},z=e=>Object.assign(q,e);var _=q;n(7);const V=["one-item","two-item","three-item","four-item"];function W(e,t={}){return e.map(({name:e,key:n,type:a,enums:s,render:l,isShow:o,unit:c="",itemCount:d=2},u)=>{let h=t[n];if(a&&h&&_[a]&&(h=_[a](h,t)),s&&s.length>0&&(h=Object(i.getEnumObject)(s,t[n]).label),l&&"function"==typeof l&&(h=l(t)),o&&!o(t))return null;const p=V[d-1],m=void 0===h||""===h?"--":h;return r.a.createElement("div",{className:`showInfo-item ${p}`,key:u},r.a.createElement("span",{className:"showInfo-label"},e),r.a.createElement("span",{className:"showInfo-value"},m,m===h?c:""))})}var K=r.a.memo(function(e){const{fields:t,detail:n={},fieldsName:a,children:s}=e;return r.a.createElement("div",{className:"doddle-render-detail"},a&&r.a.createElement("h3",{className:"title"},a),r.a.createElement("div",{className:"showInfo-content"},s?s(W):W(t,n)))}),Y=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};function G(e,t){let n=t.type||t.enums&&"enum";return n=_.hasOwnProperty(n)?n:"normal",_[n](e,t)}var H={combineTypes:z,getFieldValue:G,createColumns:function(e,t,n){const a={};let r=[];const s=e=>(e=[].concat(e),r=e.map(e=>{let t=r.find(t=>e==(t.key||t.dataIndex));return t||(t={dataIndex:e,title:e,render:e=>G(e)}),t}),a),i=e=>(Array.isArray(e)||(e=Object.keys(e).map(t=>Object.assign(e[t],{key:t}))),e.forEach(e=>{let{dataIndex:t,title:n,key:a,name:s}=e,i=Y(e,["dataIndex","title","key","name"]);(e=Object.assign({dataIndex:a||t,title:s||n},i)).hasOwnProperty("title")&&null==e.title&&delete e.title;const l=r.find(t=>t.dataIndex==e.dataIndex);l?Object.assign(l,e):r.push(e)}),a);return r=(e=>e.map(e=>{let{dataIndex:t,title:n,key:a,name:r,render:s}=e,i=Y(e,["dataIndex","title","key","name","render"]);return s||(s=t=>G(t,e)),Object.assign({dataIndex:a||t,title:r||n,render:s},i)}))(e),t&&s(t),n&&i(n),Object.assign(a,{pick:s,excludes:e=>(e=[].concat(e),r=r.filter(t=>!e.includes(t.dataIndex)),a),enhance:i,values:()=>r})}},Z=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};const{createColumns:X}=H;class J extends r.a.PureComponent{constructor(e){super(e),this.state={}}getInitalColumns(e){const{extraFields:t=[]}=this.props;return X(e).enhance(t).values()}render(){const e=this.props,{fields:t,search:n={},datas:a,total:i=0,loading:l={},onSearch:o,rowKey:c="id",footer:d,noPage:u=!1,pageName:h=J.PN}=e,p=Z(e,["fields","search","datas","total","loading","onSearch","rowKey","footer","noPage","pageName"]),m=this.getInitalColumns(t),g=n.pageNum?"pageNum":h,f=u?null:{total:i,current:n[g],pageSize:n.pageCount||n.pageSize,onChange:e=>o({[g]:e}),showTotal:e=>d?d(Object.assign({total:i},n)):`共 ${e} 条`},b=Object.assign({columns:m,pagination:f,bordered:!0,dataSource:a,loading:l.list,rowKey:c},p);return r.a.createElement("div",{style:{marginTop:20}},r.a.createElement(s.Table,Object.assign({},b)))}}J.PN="pageNo",J.PS="pageSize";class Q extends r.a.PureComponent{constructor(e){super(e);const{visible:t}=e;this.state={visible:Boolean(t)},this.handleCancel=this.handleCancel.bind(this),this.handleOk=this.handleOk.bind(this)}componentWillReceiveProps({visible:e,confirmLoading:t}){return!1===e?this.setState({visible:e}):(e&&e!==this.props.visible&&this.setState({visible:!0}),void 0!==t&&!1===t.valueOf()&&this.props.confirmLoading&&this.props.confirmLoading.valueOf()&&(t.hasOwnProperty("done")&&!t.done||this.setState({visible:!1})),!0)}handleCancel(){this.props.onCancel&&this.props.onCancel(),this.setState({visible:!1})}handleOk(){const{confirmLoading:e,form:t,onOk:n}=this.props,a=()=>{void 0===e&&this.handleCancel()};n&&t?t.validateFields((e,t)=>{if(e)return;n(t)&&a()}):(n&&n(),a())}render(){let{confirmLoading:e}=this.props;void 0!==e&&(e=e.valueOf());const t=Object.assign({},this.props,{confirmLoading:e,visible:!0,onOk:this.handleOk,onCancel:this.handleCancel});return r.a.createElement("div",null,this.state.visible&&r.a.createElement(s.Modal,Object.assign({},t),this.props.children))}}n.d(t,"WithSearch",function(){return T}),n.d(t,"OriginSearch",function(){return u}),n.d(t,"DynamicForm",function(){return U}),n.d(t,"DaynamicForm",function(){return U}),n.d(t,"InputWithUnit",function(){return v}),n.d(t,"formRender",function(){return D}),n.d(t,"RenderDetail",function(){return K}),n.d(t,"EnhanceTable",function(){return J}),n.d(t,"HModal",function(){return Q}),n.d(t,"FileUpload",function(){return f}),n.d(t,"extendFieldTypes",function(){return z}),n.d(t,"extendRenderTypes",function(){return S})}])});