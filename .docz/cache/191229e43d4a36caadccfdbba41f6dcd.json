{"remainingRequest":"/Users/apple/Documents/project/antd-doddle/node_modules/babel-loader/lib/index.js?{\"presets\":[\"@babel/preset-env\",\"@babel/preset-react\",[\"/Users/apple/Documents/project/antd-doddle/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-proposal-object-rest-spread\",[\"@babel/plugin-proposal-decorators\",{\"legacy\":true}],\"@babel/plugin-proposal-class-properties\",\"@babel/plugin-transform-classes\",[\"/Users/apple/Documents/project/antd-doddle/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/apple/Documents/project/antd-doddle/node_modules/react-hot-loader/babel.js\"],\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js","dependencies":[{"path":"/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js","mtime":1551191122131},{"path":"/Users/apple/Documents/project/antd-doddle/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Documents/project/antd-doddle/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var _jsxFileName = \"/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nimport React from 'react';\nimport { Input, AutoComplete, Spin, Icon } from 'antd';\nimport { throttle, isEmpty } from '../utils';\nimport './index.less';\nvar Option = AutoComplete.Option;\nvar DefaultOption = React.createElement(Option, {\n  key: \"empty\",\n  disabled: true,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 7\n  },\n  __self: this\n}, \"\\u6682\\u65E0\\u53EF\\u5339\\u914D\\u7684\\u641C\\u7D22\\u7ED3\\u679C\");\n/**\n * 作用: 用户名远程搜索下拉列表选择框\n * @prop: { function }      onSelect     下拉列表选择后自定义动作\n * @prop: { function }      onChange     下拉列表选择后自定义动作，一般不使用，与handleSelect功能相似\n * @prop: { function }      format       下拉列表显示自定义规则函数，返回[{label: '',value: ''}]对象数组\n * @prop: { Promise func }  fetchData    带promise的数据获取接口\n * @prop: { string|object } value        初始值\n * @prop: { function }      valueFormat  数据显示框自定义数据显示函数。默认为 value => value\n * @prop: { object }        search       自定义搜索数据对象，不设置则采用默认itmp默认用户查询对象\n * @prop: { string }        searchKey    自定义搜索数据对象，关键词属性名，默认keyword\n */\n\nvar HInputSearch =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(HInputSearch, _React$Component);\n\n  function HInputSearch(props) {\n    var _this;\n\n    _classCallCheck(this, HInputSearch);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HInputSearch).call(this, props));\n    _this.state = {\n      isShowSearch: false,\n      loading: false,\n      options: [],\n      seachRes: [],\n      value: props.value,\n      search: props.search || {}\n    };\n    _this.lastFethId = 0;\n    _this.load = _this.load.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleSelect = _this.handleSelect.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleOpenSearch = _this.handleOpenSearch.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleCloseSearch = _this.handleCloseSearch.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChangeVisible = _this.handleChangeVisible.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.lazyLoad = throttle(_this.load);\n    return _this;\n  }\n\n  _createClass(HInputSearch, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var value = nextProps.value;\n\n      if (isEmpty(value) && value !== this.props.value) {\n        this.setState({\n          value: nextProps.value\n        });\n      }\n    }\n  }, {\n    key: \"handleChangeVisible\",\n    value: function handleChangeVisible(event) {\n      var isShowSearch = this.state.isShowSearch; // eslint-disable-next-line\n\n      event = event || window.event;\n      var elem = event.target;\n      var inComponentClick = false;\n\n      if (this.searchInputElement && this.searchInputElement.contains(elem) || (elem.className || '').indexOf('ant-select-dropdown') !== -1) {\n        inComponentClick = true;\n      }\n\n      !inComponentClick && isShowSearch && this.handleCloseSearch();\n    }\n  }, {\n    key: \"load\",\n    value: function load(params) {\n      var _this2 = this;\n\n      this.lastFethId += 1;\n      var fetchId = this.lastFethId;\n      var _this$props = this.props,\n          fetchData = _this$props.fetchData,\n          format = _this$props.format; // 设置loading状态，清空option\n\n      this.setState({\n        loading: true,\n        options: null\n      }); // 获取数据，并格式化数据\n\n      fetchData(params).then(function (list) {\n        if (fetchId !== _this2.lastFethId) {\n          // 异步程序，保证回调是按顺序进行\n          return;\n        }\n\n        var options;\n\n        if (isEmpty(list)) {\n          options = [DefaultOption];\n        } else {\n          // 用户自定义数据格式转换；\n          options = format(list).map(function (_ref, key) {\n            var label = _ref.label,\n                value = _ref.value;\n            return React.createElement(Option, {\n              key: key,\n              value: String(value),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 77\n              },\n              __self: this\n            }, label);\n          });\n        } // 如果options为空，则设置为暂无搜索结果\n\n\n        !options.length && options.push(DefaultOption);\n\n        _this2.setState({\n          options: options,\n          loading: false,\n          seachRes: list\n        });\n      });\n    }\n  }, {\n    key: \"handleOpenSearch\",\n    value: function handleOpenSearch() {\n      this.setState({\n        isShowSearch: true\n      });\n    }\n  }, {\n    key: \"handleCloseSearch\",\n    value: function handleCloseSearch() {\n      this.setState({\n        isShowSearch: false\n      });\n    }\n  }, {\n    key: \"handleSelect\",\n    value: function handleSelect(value, option) {\n      var onSelect = this.props.onSelect;\n      var seachRes = this.state.seachRes; // 兼容antd不同版本\n\n      var index = option.key || option.props.index; // 如果定义了handleSelect， 则获取自定义值，否则获取选择的默认值\n\n      var selectValue = onSelect ? onSelect(value, index, seachRes) : value;\n      this.triggerChange(selectValue);\n      this.setState({\n        value: selectValue\n      });\n      this.handleCloseSearch();\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(value) {\n      var _this$props$searchKey = this.props.searchKey,\n          searchKey = _this$props$searchKey === void 0 ? 'keyword' : _this$props$searchKey;\n      var search = this.state.search;\n\n      var res = _objectSpread({}, search, _defineProperty({}, searchKey, value));\n\n      value && this.lazyLoad(res);\n    }\n  }, {\n    key: \"triggerChange\",\n    value: function triggerChange(value) {\n      var onChange = this.props.onChange;\n      onChange && onChange(value);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          style = _this$props2.style,\n          _this$props2$valueFor = _this$props2.valueFormat,\n          valueFormat = _this$props2$valueFor === void 0 ? function (value) {\n        return value;\n      } : _this$props2$valueFor,\n          _this$props2$size = _this$props2.size,\n          size = _this$props2$size === void 0 ? 'default' : _this$props2$size,\n          _this$props2$disabled = _this$props2.disabled,\n          disabled = _this$props2$disabled === void 0 ? false : _this$props2$disabled,\n          _this$props2$placehol = _this$props2.placeholder,\n          placeholder = _this$props2$placehol === void 0 ? '请输入' : _this$props2$placehol;\n      var _this$state = this.state,\n          options = _this$state.options,\n          isShowSearch = _this$state.isShowSearch,\n          value = _this$state.value,\n          loading = _this$state.loading; // 有搜索框时就禁止输入，且没有点击事件。无搜索框时就可以点击\n\n      var inputProps = isShowSearch ? {\n        disabled: true\n      } : {\n        onClick: this.handleOpenSearch\n      };\n      return React.createElement(\"div\", {\n        className: \"ffe-origin-search\",\n        style: style // eslint-disable-next-line\n        ,\n        ref: function ref(el) {\n          return _this3.searchInputElement = el;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(Input // eslint-disable-next-line\n      , Object.assign({\n        disabled: disabled,\n        ref: function ref(e) {\n          return _this3.searchInput = e;\n        },\n        readOnly: true,\n        placeholder: placeholder,\n        value: valueFormat(value),\n        style: {\n          width: '100%'\n        },\n        size: size\n      }, inputProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      })), isShowSearch && React.createElement(\"div\", {\n        className: \"js-origin-search origin-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        type: \"search\",\n        className: \"origin-search-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }), React.createElement(AutoComplete, {\n        autoFocus: true,\n        className: \"certain-category-search\",\n        dropdownClassName: \"certain-category-search-dropdown\",\n        dropdownMatchSelectWidth: true,\n        size: size,\n        onBlur: this.handleCloseSearch,\n        onSearch: this.handleChange,\n        onSelect: this.handleSelect,\n        style: {\n          width: '100%'\n        },\n        optionLabelProp: \"value\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, loading ? [React.createElement(Option, {\n        key: \"loading\",\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(Spin, {\n        spinning: loading,\n        style: {\n          paddingLeft: '45%',\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }))] : options)));\n    }\n  }]);\n\n  return HInputSearch;\n}(React.Component);\n\nexport { HInputSearch as default };\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(Option, \"Option\", \"/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js\");\n  reactHotLoader.register(DefaultOption, \"DefaultOption\", \"/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js\");\n  reactHotLoader.register(HInputSearch, \"HInputSearch\", \"/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();\n\nHInputSearch.__docgenInfo = {\n  \"description\": \"\\u4F5C\\u7528: \\u7528\\u6237\\u540D\\u8FDC\\u7A0B\\u641C\\u7D22\\u4E0B\\u62C9\\u5217\\u8868\\u9009\\u62E9\\u6846\\n@prop: { function }      onSelect     \\u4E0B\\u62C9\\u5217\\u8868\\u9009\\u62E9\\u540E\\u81EA\\u5B9A\\u4E49\\u52A8\\u4F5C\\n@prop: { function }      onChange     \\u4E0B\\u62C9\\u5217\\u8868\\u9009\\u62E9\\u540E\\u81EA\\u5B9A\\u4E49\\u52A8\\u4F5C\\uFF0C\\u4E00\\u822C\\u4E0D\\u4F7F\\u7528\\uFF0C\\u4E0EhandleSelect\\u529F\\u80FD\\u76F8\\u4F3C\\n@prop: { function }      format       \\u4E0B\\u62C9\\u5217\\u8868\\u663E\\u793A\\u81EA\\u5B9A\\u4E49\\u89C4\\u5219\\u51FD\\u6570\\uFF0C\\u8FD4\\u56DE[{label: '',value: ''}]\\u5BF9\\u8C61\\u6570\\u7EC4\\n@prop: { Promise func }  fetchData    \\u5E26promise\\u7684\\u6570\\u636E\\u83B7\\u53D6\\u63A5\\u53E3\\n@prop: { string|object } value        \\u521D\\u59CB\\u503C\\n@prop: { function }      valueFormat  \\u6570\\u636E\\u663E\\u793A\\u6846\\u81EA\\u5B9A\\u4E49\\u6570\\u636E\\u663E\\u793A\\u51FD\\u6570\\u3002\\u9ED8\\u8BA4\\u4E3A value => value\\n@prop: { object }        search       \\u81EA\\u5B9A\\u4E49\\u641C\\u7D22\\u6570\\u636E\\u5BF9\\u8C61\\uFF0C\\u4E0D\\u8BBE\\u7F6E\\u5219\\u91C7\\u7528\\u9ED8\\u8BA4itmp\\u9ED8\\u8BA4\\u7528\\u6237\\u67E5\\u8BE2\\u5BF9\\u8C61\\n@prop: { string }        searchKey    \\u81EA\\u5B9A\\u4E49\\u641C\\u7D22\\u6570\\u636E\\u5BF9\\u8C61\\uFF0C\\u5173\\u952E\\u8BCD\\u5C5E\\u6027\\u540D\\uFF0C\\u9ED8\\u8BA4keyword\",\n  \"methods\": [{\n    \"name\": \"handleChangeVisible\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"event\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"load\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"params\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleOpenSearch\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }, {\n    \"name\": \"handleCloseSearch\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }, {\n    \"name\": \"handleSelect\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"value\",\n      \"type\": null\n    }, {\n      \"name\": \"option\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"handleChange\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"value\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }, {\n    \"name\": \"triggerChange\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"value\",\n      \"type\": null\n    }],\n    \"returns\": null\n  }],\n  \"displayName\": \"HInputSearch\"\n};",{"version":3,"sources":["/Users/apple/Documents/project/antd-doddle/src/components/OriginSearch.js"],"names":["React","Input","AutoComplete","Spin","Icon","throttle","isEmpty","Option","DefaultOption","HInputSearch","props","state","isShowSearch","loading","options","seachRes","value","search","lastFethId","load","bind","handleChange","handleSelect","handleOpenSearch","handleCloseSearch","handleChangeVisible","lazyLoad","nextProps","setState","event","window","elem","target","inComponentClick","searchInputElement","contains","className","indexOf","params","fetchId","fetchData","format","then","list","map","key","label","String","length","push","option","onSelect","index","selectValue","triggerChange","searchKey","res","onChange","style","valueFormat","size","disabled","placeholder","inputProps","onClick","el","e","searchInput","width","paddingLeft","textAlign","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Input, AutoComplete, Spin, Icon } from 'antd';\nimport { throttle, isEmpty } from '../utils';\nimport './index.less';\n\nconst { Option } = AutoComplete;\nconst DefaultOption = <Option key=\"empty\" disabled>暂无可匹配的搜索结果</Option>;\n\n/**\n * 作用: 用户名远程搜索下拉列表选择框\n * @prop: { function }      onSelect     下拉列表选择后自定义动作\n * @prop: { function }      onChange     下拉列表选择后自定义动作，一般不使用，与handleSelect功能相似\n * @prop: { function }      format       下拉列表显示自定义规则函数，返回[{label: '',value: ''}]对象数组\n * @prop: { Promise func }  fetchData    带promise的数据获取接口\n * @prop: { string|object } value        初始值\n * @prop: { function }      valueFormat  数据显示框自定义数据显示函数。默认为 value => value\n * @prop: { object }        search       自定义搜索数据对象，不设置则采用默认itmp默认用户查询对象\n * @prop: { string }        searchKey    自定义搜索数据对象，关键词属性名，默认keyword\n */\nexport default class HInputSearch extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isShowSearch: false,\n      loading: false,\n      options: [],\n      seachRes: [],\n      value: props.value,\n      search: props.search || {}\n    };\n    this.lastFethId = 0;\n    this.load = this.load.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.handleOpenSearch = this.handleOpenSearch.bind(this);\n    this.handleCloseSearch = this.handleCloseSearch.bind(this);\n    this.handleChangeVisible = this.handleChangeVisible.bind(this);\n    this.lazyLoad = throttle(this.load);\n  }\n  componentWillReceiveProps(nextProps) {\n    const { value } = nextProps;\n    if (isEmpty(value) && value !== this.props.value) {\n      this.setState({ value: nextProps.value });\n    }\n  }\n  handleChangeVisible(event) {\n    const { isShowSearch } = this.state;\n    // eslint-disable-next-line\n    event = event || window.event;\n    const elem = event.target;\n    let inComponentClick = false;\n    if (\n      (this.searchInputElement && this.searchInputElement.contains(elem)) ||\n      ((elem.className || '').indexOf('ant-select-dropdown') !== -1)\n    ) {\n      inComponentClick = true;\n    }\n    !inComponentClick && isShowSearch && this.handleCloseSearch();\n  }\n  load(params) {\n    this.lastFethId += 1;\n    const fetchId = this.lastFethId;\n    const { fetchData, format } = this.props;\n    // 设置loading状态，清空option\n    this.setState({ loading: true, options: null });\n    // 获取数据，并格式化数据\n    fetchData(params).then((list) => {\n      if (fetchId !== this.lastFethId) { // 异步程序，保证回调是按顺序进行\n        return;\n      }\n      let options;\n      if (isEmpty(list)) {\n        options = [DefaultOption];\n      } else {\n        // 用户自定义数据格式转换；\n        options = format(list).map(({ label, value }, key) => (\n          <Option key={key} value={String(value)}>{label}</Option>));\n      }\n      // 如果options为空，则设置为暂无搜索结果\n      !options.length && options.push(DefaultOption);\n      this.setState({ options, loading: false, seachRes: list });\n    });\n  }\n  handleOpenSearch() {\n    this.setState({ isShowSearch: true });\n  }\n  handleCloseSearch() {\n    this.setState({ isShowSearch: false });\n  }\n  handleSelect(value, option) {\n    const { onSelect } = this.props;\n    const { seachRes } = this.state;\n    // 兼容antd不同版本\n    const index = option.key || option.props.index;\n    // 如果定义了handleSelect， 则获取自定义值，否则获取选择的默认值\n    const selectValue = onSelect ? onSelect(value, index, seachRes) : value;\n    this.triggerChange(selectValue);\n    this.setState({ value: selectValue });\n    this.handleCloseSearch();\n  }\n  handleChange(value) {\n    const { searchKey = 'keyword' } = this.props;\n    const { search } = this.state;\n    const res = { ...search, [searchKey]: value };\n    value && this.lazyLoad(res);\n  }\n  triggerChange(value) {\n    const { onChange } = this.props;\n    onChange && onChange(value);\n  }\n  render() {\n    const { style, valueFormat = value => value, size = 'default', disabled = false, placeholder = '请输入' } = this.props;\n    const { options, isShowSearch, value, loading } = this.state;\n    // 有搜索框时就禁止输入，且没有点击事件。无搜索框时就可以点击\n    const inputProps = isShowSearch ? { disabled: true } : {\n      onClick: this.handleOpenSearch,\n    };\n    return (\n      <div\n        className=\"ffe-origin-search\"\n        style={style}\n        // eslint-disable-next-line\n        ref={el => this.searchInputElement = el}\n      >\n        <Input\n          // eslint-disable-next-line\n          disabled={disabled}\n          ref={e => this.searchInput = e}\n          readOnly\n          placeholder={placeholder}\n          value={valueFormat(value)}\n          style={{ width: '100%' }}\n          size={size}\n          {...inputProps}\n        />\n        {\n          isShowSearch &&\n          <div className=\"js-origin-search origin-search\">\n            <Icon type=\"search\" className=\"origin-search-icon\" />\n            <AutoComplete\n              autoFocus\n              className=\"certain-category-search\"\n              dropdownClassName=\"certain-category-search-dropdown\"\n              dropdownMatchSelectWidth\n              size={size}\n              onBlur={this.handleCloseSearch}\n              onSearch={this.handleChange}\n              onSelect={this.handleSelect}\n              style={{ width: '100%' }}\n              optionLabelProp=\"value\"\n            >\n              {loading ?\n                [\n                  <Option key=\"loading\" disabled>\n                    <Spin spinning={loading} style={{ paddingLeft: '45%', textAlign: 'center' }} />\n                  </Option>\n                ] : options\n              }\n            </AutoComplete>\n          </div>\n        }\n      </div>\n    );\n  }\n}\n"]}]}